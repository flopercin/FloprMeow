<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MeowFlopr Casino</title>
    <link rel="icon" type="image/jpeg" href="main.jpg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            font-family: 'Press Start 2P', system-ui;
            user-select: none;
        }
        
        .neon-text {
            text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 40px #00ffff;
        }
        
        .explosion {
            animation: explode 0.6s forwards;
        }
        
        @keyframes explode {
            0% { transform: scale(0.5); opacity: 1; }
            50% { transform: scale(1.8); }
            100% { transform: scale(2.5); opacity: 0; }
        }
        
        .card-hover {
            transition: all 0.3s;
        }
        .card-hover:hover {
            transform: scale(1.02);
            box-shadow: 0 0 30px #ff00ff;
        }

        .card-locked {
            filter: grayscale(100%);
            pointer-events: none;
            position: relative;
        }

        .reel {
            height: 180px;
            overflow: hidden;
            border: 4px solid #ffd700;
            background: #111;
        }

        .rocket-container {
            position: relative;
            width: 100%;
            height: 300px;
            border-bottom: 2px solid white;
            border-left: 2px solid white;
            overflow: hidden;
            background: rgba(0,0,0,0.5);
        }

        #rocket-obj {
            position: absolute;
            width: 60px;
            bottom: 10px;
            left: 10px;
            transition: bottom 0.1s linear, left 0.1s linear;
        }
        
        .level-bar {
            transition: width 0.5s ease-out;
        }
    </style>
</head>
<body class="bg-zinc-950 text-white overflow-x-hidden">
    <header class="bg-black border-b-4 border-pink-500 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3">
                <img src="main.jpg" class="w-12 h-12 rounded-full border-2 border-pink-500 object-cover">
                <div>
                    <h1 class="text-2xl font-bold neon-text tracking-widest">MEOWFLOPR</h1>
                </div>
            </div>
            
            <div class="flex items-center gap-4 text-[10px] md:text-xs">
                <div class="flex flex-col items-end mr-4">
                    <div class="text-pink-400 mb-1">LVL <span id="level-display">1</span></div>
                    <div class="w-32 h-2 bg-zinc-800 rounded-full overflow-hidden border border-zinc-600">
                        <div id="xp-bar" class="h-full bg-gradient-to-r from-pink-500 to-purple-500 level-bar" style="width: 0%"></div>
                    </div>
                </div>

                <div id="balance-display" class="bg-zinc-900 px-4 py-2 rounded-full border-2 border-emerald-400 flex items-center gap-2 font-bold">
                    <span class="text-emerald-400">‚ÇΩ</span>
                    <span id="balance">10000</span>
                </div>
                
                <div onclick="showProfile()" class="flex items-center gap-2 cursor-pointer hover:opacity-80">
                    <div id="username-display" class="text-pink-400">–ò–ì–†–û–ö</div>
                    <div class="w-8 h-8 bg-pink-500 rounded-full flex items-center justify-center">üë§</div>
                </div>
            </div>
        </div>
    </header>

    <section id="home" class="relative min-h-screen flex items-center justify-center bg-[radial-gradient(at_center,#4c1d95_0%,#000_70%)] py-20">
        <div class="text-center z-10 px-6 max-w-4xl w-full">
            <h1 class="text-4xl md:text-6xl font-black tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-cyan-400 mb-8">MEOWFLOPR CASINO</h1>
            
            <button onclick="showGames()" class="bg-gradient-to-r from-pink-500 to-purple-600 hover:scale-105 px-10 py-5 text-xl font-bold rounded-xl border-4 border-white transition mb-16 shadow-[0_0_30px_rgba(236,72,153,0.5)]">
                –ò–ì–†–ê–¢–¨
            </button>

            <div class="bg-zinc-900/80 border-2 border-yellow-500 rounded-xl p-6 max-w-2xl mx-auto">
                <h3 class="text-yellow-400 text-xl mb-4">üèÜ –¢–û–ü –ë–û–ì–ê–¢–ï–ô–®–ò–•</h3>
                <div class="space-y-3 text-sm">
                    <div class="flex justify-between items-center border-b border-zinc-700 pb-2">
                        <div class="flex items-center gap-2">
                            <span class="text-yellow-500">#1</span>
                            <span>MeowFlopr</span>
                            <span class="text-[10px] bg-yellow-500 text-black px-1 rounded">ADMIN</span>
                        </div>
                        <div class="text-emerald-400">1 488 000 000 ‚ÇΩ</div>
                    </div>
                    <div class="flex justify-between items-center border-b border-zinc-700 pb-2 opacity-50">
                        <div class="flex items-center gap-2">
                            <span>#2</span>
                            <span>Barbariki</span>
                        </div>
                        <div class="text-emerald-400">500 000 ‚ÇΩ</div>
                    </div>
                     <div class="flex justify-between items-center opacity-50">
                        <div class="flex items-center gap-2">
                            <span>#3</span>
                            <span>Udalo</span>
                        </div>
                        <div class="text-emerald-400">12 000 ‚ÇΩ</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="games" class="max-w-7xl mx-auto px-6 py-12 hidden">
        <div class="flex justify-between items-center mb-10">
            <button onclick="showSection('home')" class="text-sm text-zinc-500 hover:text-white">‚Üê –ù–ê–ó–ê–î</button>
            <h2 class="text-3xl font-bold neon-text">–ò–ì–†–´</h2>
            <div class="w-10"></div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div onclick="openSlotsModal()" class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-yellow-400 cursor-pointer relative group">
                <img src="https://cdn.nur.kz/images/1200x675/36135d7df8b99f1afe63116c264a570c.jpeg?version=1" class="w-full h-48 object-cover">
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-2">–°–õ–û–¢–´ –ú–ï–õ–°–¢–†–û–Ø</h3>
                    <p class="text-zinc-400 text-xs mb-4">–°–ª–æ–∂–Ω–æ, –Ω–æ –º–æ–∂–Ω–æ.</p>
                    <div class="text-xs text-yellow-500">LVL 1+</div>
                </div>
            </div>
            
            <div id="game-epstein" onclick="openEpsteinModal()" class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-red-500 cursor-pointer relative">
                <div class="absolute inset-0 bg-black/80 flex flex-col items-center justify-center z-10 lock-overlay">
                    <i class="fas fa-lock text-4xl text-zinc-500 mb-2"></i>
                    <span class="text-red-500 font-bold">–¢–†–ï–ë–£–ï–¢–°–Ø 5 –£–†–û–í–ï–ù–¨</span>
                </div>
                <img src="https://nypost.com/wp-content/uploads/sites/2/2019/08/jeffrey-epstein-2-3.jpg?quality=75&strip=all" class="w-full h-48 object-cover">
                <div class="p-6">
                    <h3 class="text-xl font-bold text-red-400 mb-2">–û–°–¢–†–û–í –≠–ü–®–¢–ï–ô–ù–ê</h3>
                    <p class="text-zinc-400 text-xs mb-4">–ë–æ–ª—å—à–∏–µ —Å—Ç–∞–≤–∫–∏ - –±–æ–ª—å—à–∏–µ —Ä–∏—Å–∫–∏.</p>
                    <div class="text-xs text-red-500">LVL 5+</div>
                </div>
            </div>

            <div id="game-mrbeast" onclick="openBeastModal()" class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-blue-500 cursor-pointer relative">
                <div class="absolute inset-0 bg-black/80 flex flex-col items-center justify-center z-10 lock-overlay">
                    <i class="fas fa-lock text-4xl text-zinc-500 mb-2"></i>
                    <span class="text-blue-500 font-bold">–¢–†–ï–ë–£–ï–¢–°–Ø 10 –£–†–û–í–ï–ù–¨</span>
                </div>
                <img src="mrbeast.jpg" class="w-full h-48 object-cover">
                <div class="p-6">
                    <h3 class="text-xl font-bold text-blue-400 mb-2">BEAST CRASH</h3>
                    <p class="text-zinc-400 text-xs mb-4">–£—Å–ø–µ–π –∑–∞–±—Ä–∞—Ç—å –¥–æ –≤–∑—Ä—ã–≤–∞.</p>
                    <div class="text-xs text-blue-500">LVL 10+</div>
                </div>
            </div>
        </div>
    </section>

    <div id="login-modal" class="fixed inset-0 bg-black/90 flex items-center justify-center hidden z-[100]">
        <div class="bg-zinc-900 border-2 border-pink-500 rounded-3xl p-8 max-w-sm w-full mx-4">
            <h2 class="text-2xl text-center mb-6">–ö–¢–û –¢–´, –í–û–ò–ù?</h2>
            <input id="username-input" type="text" placeholder="–¢–í–û–ô –ù–ò–ö" class="w-full bg-black border border-pink-400 px-4 py-3 text-lg focus:outline-none rounded-xl mb-4">
            <button onclick="login()" class="w-full bg-pink-600 hover:bg-pink-700 py-4 font-bold rounded-xl transition">–ü–û–ì–ù–ê–õ–ò</button>
        </div>
    </div>

    <div id="slots-modal" class="fixed inset-0 bg-black/95 flex items-center justify-center hidden z-[100] overflow-y-auto">
        <div class="bg-zinc-950 border-4 border-yellow-400 rounded-3xl p-6 max-w-3xl w-full mx-4 my-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl md:text-3xl text-yellow-400">–°–õ–û–¢–´ –ú–ï–õ–°–¢–†–û–Ø</h2>
                <button onclick="closeModal('slots-modal')" class="text-2xl">‚úï</button>
            </div>
            
            <div class="flex justify-center gap-2 md:gap-4 mb-6">
                <div id="reel1" class="reel w-24 md:w-32 flex items-center justify-center bg-black rounded border-2 border-yellow-600"></div>
                <div id="reel2" class="reel w-24 md:w-32 flex items-center justify-center bg-black rounded border-2 border-yellow-600"></div>
                <div id="reel3" class="reel w-24 md:w-32 flex items-center justify-center bg-black rounded border-2 border-yellow-600"></div>
            </div>
            
            <div id="bet-container-slots" class="mb-6">
                <div class="grid grid-cols-4 gap-2 mb-2 standard-bets">
                    <button onclick="setBet(100)" class="bg-zinc-800 p-2 rounded hover:bg-zinc-700 text-xs">100</button>
                    <button onclick="setBet(500)" class="bg-zinc-800 p-2 rounded hover:bg-zinc-700 text-xs">500</button>
                    <button onclick="setBet(1000)" class="bg-zinc-800 p-2 rounded hover:bg-zinc-700 text-xs">1K</button>
                    <button onclick="setBet(5000)" class="bg-zinc-800 p-2 rounded hover:bg-zinc-700 text-xs">5K</button>
                </div>
                <div class="custom-bet-div hidden">
                    <input type="number" id="custom-bet-slots" placeholder="–°–≤–æ—è —Å—Ç–∞–≤–∫–∞" class="w-full bg-black border border-pink-500 p-3 rounded mb-2 text-center" onchange="setCustomBet(this.value)">
                </div>
            </div>
            
            <div class="text-center">
                <div class="text-xl mb-4">–°–¢–ê–í–ö–ê: <span id="current-bet-display" class="text-yellow-400">100</span> ‚ÇΩ</div>
                <button onclick="spinSlots()" id="spin-button" class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 text-black text-2xl font-bold py-4 rounded-xl hover:scale-105 active:scale-95 transition shadow-lg shadow-orange-500/20">–ö–†–£–¢–ò–¢–¨</button>
            </div>
            <div id="slots-result" class="text-center text-xl mt-4 min-h-[40px] font-bold"></div>
        </div>
    </div>

    <div id="epstein-modal" class="fixed inset-0 bg-black/95 flex items-center justify-center hidden z-[100] overflow-y-auto">
        <div class="bg-zinc-950 border-4 border-red-600 rounded-3xl p-6 max-w-4xl w-full mx-4 my-8">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl md:text-3xl text-red-500">–û–°–¢–†–û–í –≠–ü–®–¢–ï–ô–ù–ê</h2>
                <button onclick="closeModal('epstein-modal')" class="text-2xl">‚úï</button>
            </div>
            
            <div class="flex flex-col md:flex-row gap-6">
                <div class="w-full md:w-1/3">
                    <div class="mb-2 text-sm text-zinc-400">–°–¢–ê–í–ö–ê</div>
                    <div class="grid grid-cols-2 gap-2 mb-4 standard-bets">
                        <button onclick="setGameBet('epstein', 1000)" class="bet-btn-epstein bg-zinc-800 p-3 rounded hover:bg-red-900 text-xs">1K</button>
                        <button onclick="setGameBet('epstein', 5000)" class="bet-btn-epstein bg-zinc-800 p-3 rounded hover:bg-red-900 text-xs">5K</button>
                        <button onclick="setGameBet('epstein', 10000)" class="bet-btn-epstein bg-zinc-800 p-3 rounded hover:bg-red-900 text-xs">10K</button>
                        <button onclick="setGameBet('epstein', 25000)" class="bet-btn-epstein bg-zinc-800 p-3 rounded hover:bg-red-900 text-xs">25K</button>
                    </div>
                    <div class="custom-bet-div hidden mb-4">
                        <input type="number" id="custom-bet-epstein" placeholder="–°—É–º–º–∞" class="w-full bg-black border border-red-500 p-3 rounded text-center" onchange="setCustomBetGeneric('epstein', this.value)">
                    </div>

                    <div class="text-center mb-4 text-sm">–í –ò–ì–†–ï: <span id="epstein-current-bet">0</span> ‚ÇΩ</div>
                    
                    <button onclick="startEpstein()" id="start-epstein-btn" class="w-full bg-red-600 py-4 font-bold rounded-xl mb-4 hover:bg-red-500">–°–¢–ê–†–¢</button>
                    
                    <div id="epstein-stats" class="hidden">
                        <div class="text-emerald-400 text-xl font-bold text-center mb-2">+<span id="epstein-win-amount">0</span> ‚ÇΩ</div>
                        <button onclick="cashoutEpstein()" class="w-full bg-emerald-600 py-3 font-bold rounded-xl animate-pulse">–ó–ê–ë–†–ê–¢–¨</button>
                    </div>
                </div>
                
                <div class="w-full md:w-2/3">
                    <div id="epstein-grid" class="grid grid-cols-4 gap-2"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="beast-modal" class="fixed inset-0 bg-black/95 flex items-center justify-center hidden z-[100]">
        <div class="bg-zinc-950 border-4 border-blue-500 rounded-3xl p-6 max-w-2xl w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl md:text-2xl text-blue-400">MRBEAST CRASH</h2>
                <button onclick="closeModal('beast-modal')" class="text-2xl">‚úï</button>
            </div>

            <div class="rocket-container rounded-xl mb-6 relative bg-gradient-to-b from-slate-900 to-black">
                <div class="absolute top-4 right-4 text-4xl font-bold z-10" id="crash-multiplier">1.00x</div>
                <img src="raketmrbeast.jpg" id="rocket-obj" class="rounded-full shadow-[0_0_20px_#3b82f6]">
                <div id="crash-message" class="absolute inset-0 flex items-center justify-center text-3xl font-bold bg-black/80 hidden text-red-500">CRASHED!</div>
            </div>

            <div class="flex gap-4 items-end">
                <div class="flex-1">
                    <label class="text-xs text-zinc-500 block mb-1">–°–¢–ê–í–ö–ê</label>
                    <div class="flex gap-2 mb-2 standard-bets">
                         <button onclick="setGameBet('beast', 1000)" class="flex-1 bg-zinc-800 py-2 rounded text-xs hover:bg-blue-900">1K</button>
                         <button onclick="setGameBet('beast', 5000)" class="flex-1 bg-zinc-800 py-2 rounded text-xs hover:bg-blue-900">5K</button>
                    </div>
                     <div class="custom-bet-div hidden mb-2">
                        <input type="number" id="custom-bet-beast" placeholder="–°—É–º–º–∞" class="w-full bg-black border border-blue-500 p-2 rounded text-center" onchange="setCustomBetGeneric('beast', this.value)">
                    </div>
                </div>
                <div class="flex-1">
                    <button id="beast-action-btn" onclick="startBeast()" class="w-full h-14 bg-blue-600 hover:bg-blue-500 rounded-xl font-bold text-xl">–°–¢–ê–†–¢</button>
                </div>
            </div>
            <div class="text-center text-xs text-zinc-500 mt-2">–†–∞–∫–µ—Ç–∞ –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç.</div>
        </div>
    </div>

    <script>
        let user = {
            username: "–ò–ì–†–û–ö",
            balance: 10000,
            level: 1,
            xp: 99999,
            maxXp: 400
        };

        let currentBets = {
            slots: 100,
            epstein: 1000,
            beast: 1000
        };

        const symbols = [
            { name: "banana", url: "https://avatars.mds.yandex.net/get-mpic/5234083/img_id3506543352633991634.png/orig" },
            { name: "plum", url: "https://main-cdn.sbermegamarket.ru/big1/hlr-system/-90/257/429/371/118/48/100032397594b0.jpg" },
            { name: "grape", url: "https://avatars.mds.yandex.net/get-mpic/5145248/img_id4537599123360367823.png/orig" },
            { name: "melstroy", url: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/1024px-No_image_available.svg.png" } 
        ]; 

        let epsteinState = { active: false, winnings: 0, bet: 0 };
        let beastState = { active: false, multiplier: 1.00, interval: null, bet: 0 };

        window.onload = function() {
            loadUser();
            if (!localStorage.getItem("mf_user_v2")) {
                document.getElementById("login-modal").classList.remove("hidden");
            }
            showSection('home');
            checkLocks();
        };

        function loadUser() {
            const saved = localStorage.getItem("mf_user_v2");
            if (saved) user = JSON.parse(saved);
            updateUI();
        }

        function saveUser() {
            localStorage.setItem("mf_user_v2", JSON.stringify(user));
            updateUI();
        }

        function updateUI() {
            document.getElementById("balance").textContent = Math.floor(user.balance).toLocaleString("ru-RU");
            document.getElementById("username-display").textContent = user.username;
            document.getElementById("level-display").textContent = user.level;
            
            const xpPercent = (user.xp / user.maxXp) * 100;
            document.getElementById("xp-bar").style.width = `${xpPercent}%`;
            
            checkLocks();
            checkCustomBets();
        }

        function addXp(amount) {
            user.xp += amount;
            if (user.xp >= user.maxXp) {
                user.level++;
                user.xp = user.xp - user.maxXp;
                user.maxXp = Math.floor(user.maxXp * 1.5);
                alert(`üéâ –£–†–û–í–ï–ù–¨ –ü–û–í–´–®–ï–ù! –¢–ï–ü–ï–†–¨ –¢–´ ${user.level} LVL`);
            }
            saveUser();
        }

        function checkLocks() {
            const epstein = document.getElementById("game-epstein");
            const beast = document.getElementById("game-mrbeast");
            
            if (user.level >= 5) {
                epstein.querySelector(".lock-overlay").classList.add("hidden");
                epstein.classList.remove("card-locked");
            } else {
                epstein.querySelector(".lock-overlay").classList.remove("hidden");
                epstein.classList.add("card-locked");
            }

            if (user.level >= 10) {
                beast.querySelector(".lock-overlay").classList.add("hidden");
                beast.classList.remove("card-locked");
            } else {
                beast.querySelector(".lock-overlay").classList.remove("hidden");
                beast.classList.add("card-locked");
            }
        }

        function checkCustomBets() {
            if (user.level >= 15) {
                document.querySelectorAll(".standard-bets").forEach(el => el.classList.add("hidden"));
                document.querySelectorAll(".custom-bet-div").forEach(el => el.classList.remove("hidden"));
            }
        }

        function login() {
            const input = document.getElementById("username-input").value.trim();
            if (input) user.username = input.toUpperCase();
            document.getElementById("login-modal").classList.add("hidden");
            saveUser();
        }

        function showSection(id) {
            document.getElementById("home").classList.add("hidden");
            document.getElementById("games").classList.add("hidden");
            document.getElementById(id).classList.remove("hidden");
        }
        function showGames() { showSection("games"); }
        function showProfile() {
            const n = prompt("–ù–æ–≤—ã–π –Ω–∏–∫:", user.username);
            if(n) { user.username = n.toUpperCase(); saveUser(); }
        }

        function setBet(amount) {
            currentBets.slots = parseInt(amount);
            document.getElementById("current-bet-display").textContent = amount;
        }

        function setGameBet(game, amount) {
            currentBets[game] = parseInt(amount);
            document.querySelectorAll(`.bet-btn-${game}`).forEach(btn => {
                btn.classList.toggle('bg-zinc-600', parseInt(btn.innerText.replace('K','000')) === amount);
            });
        }

        function setCustomBet(val) {
            currentBets.slots = parseInt(val) || 100;
            document.getElementById("current-bet-display").textContent = currentBets.slots;
        }

        function setCustomBetGeneric(game, val) {
            currentBets[game] = parseInt(val) || 1000;
        }

        function closeModal(id) {
            document.getElementById(id).classList.add("hidden");
            if(id === 'beast-modal' && beastState.active) {
                forceStopBeast();
            }
        }

        function openSlotsModal() {
            document.getElementById("slots-modal").classList.remove("hidden");
            document.getElementById("slots-result").innerHTML = "";
            [1,2,3].forEach(i => document.getElementById(`reel${i}`).innerHTML = `<img src="${symbols[0].url}" class="w-full h-full object-contain">`);
        }

        function spinSlots() {
            const bet = currentBets.slots;
            if (user.balance < bet) return alert("–ù–µ—Ç –¥–µ–Ω–µ–≥!");
            
            user.balance -= bet;
            addXp(Math.max(10, Math.floor(bet / 100)));
            saveUser();

            const btn = document.getElementById("spin-button");
            btn.disabled = true;
            btn.classList.add("opacity-50");
            document.getElementById("slots-result").innerHTML = "";

            const reels = [1,2,3];
            let finalRes = [];

            // –£—Å–ª–æ–∂–Ω–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ó–ê–†–ê–ù–ï–ï
            let rand = Math.random();
            let outcome = "lose";
            if (rand < 0.05) outcome = "jackpot"; // 5% –Ω–∞ –¥–∂–µ–∫–ø–æ—Ç
            else if (rand < 0.20) outcome = "pair"; // 15% –Ω–∞ –ø–∞—Ä—É

            let sym1, sym2, sym3;
            if (outcome === "jackpot") {
                sym1 = sym2 = sym3 = Math.floor(Math.random() * 3);
            } else if (outcome === "pair") {
                sym1 = Math.floor(Math.random() * 3);
                sym2 = sym1;
                sym3 = (sym1 + 1) % 3;
            } else {
                sym1 = Math.floor(Math.random() * 3);
                sym2 = (sym1 + 1) % 3;
                sym3 = Math.floor(Math.random() * 3);
            }
            finalRes = [symbols[sym1], symbols[sym2], symbols[sym3]];

            reels.forEach((r, i) => {
                let el = document.getElementById(`reel${r}`);
                let count = 0;
                let interval = setInterval(() => {
                    el.innerHTML = `<img src="${symbols[Math.floor(Math.random()*3)].url}" class="w-full h-full object-contain filter blur-sm">`;
                    count++;
                    if(count > 10 + (i*5)) {
                        clearInterval(interval);
                        el.innerHTML = `<img src="${finalRes[i].url}" class="w-full h-full object-contain">`;
                        if(i===2) checkSlotsWin(finalRes);
                    }
                }, 100);
            });
        }

        function checkSlotsWin(res) {
            const bet = currentBets.slots;
            const btn = document.getElementById("spin-button");
            const disp = document.getElementById("slots-result");
            btn.disabled = false;
            btn.classList.remove("opacity-50");

            if(res[0].name === res[1].name && res[1].name === res[2].name) {
                const win = bet * 20; 
                user.balance += win;
                disp.innerHTML = `<span class="text-emerald-400">–î–ñ–ï–ö–ü–û–¢! +${win}</span>`;
            } else if (res[0].name === res[1].name || res[1].name === res[2].name || res[0].name === res[2].name) {
                const win = bet * 2;
                user.balance += win;
                disp.innerHTML = `<span class="text-emerald-400">–ü–ê–†–ê! +${win}</span>`;
            } else {
                disp.innerHTML = `<span class="text-red-500">–ü–£–°–¢–û...</span>`;
            }
            saveUser();
        }

        function openEpsteinModal() {
            if(user.level < 5) return;
            document.getElementById("epstein-modal").classList.remove("hidden");
            resetEpstein();
        }

        function resetEpstein() {
            epsteinState = { active: false, winnings: 0, bet: 0 };
            document.getElementById("epstein-grid").innerHTML = "";
            document.getElementById("start-epstein-btn").disabled = false;
            document.getElementById("start-epstein-btn").classList.remove("hidden");
            document.getElementById("epstein-stats").classList.add("hidden");
            document.getElementById("epstein-current-bet").textContent = "0";
            
            for(let i=0; i<16; i++) {
                const d = document.createElement("div");
                d.className = "aspect-square bg-zinc-800 rounded-xl border-2 border-zinc-700 flex items-center justify-center text-2xl cursor-not-allowed opacity-50";
                d.innerHTML = "?";
                document.getElementById("epstein-grid").appendChild(d);
            }
        }

        function startEpstein() {
            const bet = currentBets.epstein;
            if(user.balance < bet) return alert("–ù–µ—Ç –¥–µ–Ω–µ–≥!");
            
            user.balance -= bet;
            epsteinState.bet = bet;
            epsteinState.active = true;
            addXp(Math.max(20, Math.floor(bet / 50)));
            saveUser();

            document.getElementById("epstein-current-bet").textContent = bet;
            document.getElementById("start-epstein-btn").classList.add("hidden");
            document.getElementById("epstein-stats").classList.remove("hidden");
            document.getElementById("epstein-win-amount").textContent = "0";

            const grid = document.getElementById("epstein-grid");
            grid.innerHTML = "";
            
            let bombs = Array(4).fill("bomb").concat(Array(12).fill("safe")).sort(()=>Math.random()-0.5);

            bombs.forEach(type => {
                const cell = document.createElement("div");
                cell.className = "aspect-square bg-zinc-800 rounded-xl border-2 border-zinc-700 flex items-center justify-center text-2xl cursor-pointer hover:border-red-500 transition";
                cell.innerHTML = "üèùÔ∏è";
                cell.onclick = () => clickEpsteinCell(cell, type);
                grid.appendChild(cell);
            });
        }

        function clickEpsteinCell(cell, type) {
            if(!epsteinState.active || cell.classList.contains("revealed")) return;
            cell.classList.add("revealed");

            if(type === "bomb") {
                cell.innerHTML = "üí•";
                cell.className = "aspect-square bg-red-900 rounded-xl border-2 border-red-500 flex items-center justify-center text-4xl explosion";
                epsteinState.active = false;
                setTimeout(() => {
                    alert("–ë–£–ú! –≠–ø—à—Ç–µ–π–Ω —Ç–µ–±—è –ø–æ–π–º–∞–ª. –í—Å–µ —Å–≥–æ—Ä–µ–ª–æ.");
                    resetEpstein();
                }, 500);
            } else {
                const prize = Math.floor(Math.random() * 8000) + 2000;
                epsteinState.winnings += prize;
                document.getElementById("epstein-win-amount").textContent = epsteinState.winnings;
                
                cell.innerHTML = `<div class="text-center"><div class="text-2xl">üí∞</div><div class="text-[10px] text-green-400">+${prize}</div></div>`;
                cell.className = "aspect-square bg-green-900 rounded-xl border-2 border-green-500 flex items-center justify-center";
            }
        }

        function cashoutEpstein() {
            if(!epsteinState.active) return;
            user.balance += epsteinState.winnings;
            epsteinState.active = false;
            saveUser();
            alert(`–í—ã –≤—ã–Ω–µ—Å–ª–∏ —Å –æ—Å—Ç—Ä–æ–≤–∞ ${epsteinState.winnings} ‚ÇΩ!`);
            resetEpstein();
        }

        function openBeastModal() {
            if(user.level < 10) return;
            document.getElementById("beast-modal").classList.remove("hidden");
            resetBeast();
        }

        function resetBeast() {
            beastState = { active: false, multiplier: 1.00, interval: null, bet: 0 };
            document.getElementById("crash-multiplier").textContent = "1.00x";
            document.getElementById("crash-multiplier").className = "absolute top-4 right-4 text-4xl font-bold z-10 text-white";
            document.getElementById("crash-message").classList.add("hidden");
            document.getElementById("rocket-obj").style.bottom = "10px";
            document.getElementById("rocket-obj").style.left = "10px";
            
            const btn = document.getElementById("beast-action-btn");
            btn.textContent = "–°–¢–ê–†–¢";
            btn.classList.remove("bg-emerald-500");
            btn.classList.add("bg-blue-600");
            btn.disabled = false;
        }

        function startBeast() {
            if(beastState.active) {
                finishBeast(true);
                return;
            }

            const bet = currentBets.beast;
            if(user.balance < bet) return alert("–ù–µ—Ç –¥–µ–Ω–µ–≥!");
            
            user.balance -= bet;
            beastState.bet = bet;
            saveUser();

            beastState.active = true;
            addXp(Math.max(30, Math.floor(bet / 20)));

            const btn = document.getElementById("beast-action-btn");
            btn.textContent = "–ó–ê–ë–†–ê–¢–¨";
            btn.classList.remove("bg-blue-600");
            btn.classList.add("bg-emerald-500");

            let speed = 0.01;
            let crashPoint = (Math.random() * 0.9 + 0.1) * (Math.random() * 10 + 1); 
            if(Math.random() < 0.3) crashPoint = 1.1; 

            beastState.multiplier = 1.00;
            const rocket = document.getElementById("rocket-obj");

            beastState.interval = setInterval(() => {
                beastState.multiplier += speed;
                speed += 0.0005; 
                
                document.getElementById("crash-multiplier").textContent = beastState.multiplier.toFixed(2) + "x";

                let progress = Math.min((beastState.multiplier - 1) / 5, 1);
                rocket.style.bottom = (10 + progress * 230) + "px";
                rocket.style.left = (10 + progress * 500) + "px";

                if(beastState.multiplier >= crashPoint) {
                    finishBeast(false);
                }
            }, 50);
        }

        function finishBeast(win) {
            clearInterval(beastState.interval);
            beastState.active = false;
            const btn = document.getElementById("beast-action-btn");
            btn.disabled = true;

            if(win) {
                const winAmount = Math.floor(beastState.bet * beastState.multiplier);
                user.balance += winAmount;
                saveUser();
                document.getElementById("crash-multiplier").className = "absolute top-4 right-4 text-4xl font-bold z-10 text-emerald-400";
                btn.textContent = `+${winAmount}`;
                setTimeout(resetBeast, 2000);
            } else {
                document.getElementById("crash-message").classList.remove("hidden");
                document.getElementById("crash-multiplier").className = "absolute top-4 right-4 text-4xl font-bold z-10 text-red-500";
                btn.textContent = "CRASHED";
                btn.classList.remove("bg-emerald-500");
                btn.classList.add("bg-red-600");
                setTimeout(resetBeast, 2000);
            }
        }

        function forceStopBeast() {
            clearInterval(beastState.interval);
            beastState.active = false;
        }
    </script>
</body>
</html>
