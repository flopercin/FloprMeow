<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MeowFlopr Casino</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            font-family: 'Press Start 2P', system-ui;
        }
        
        .neon-text {
            text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 40px #00ffff;
        }
        
        .slot-reel {
            transition: all 0.1s linear;
        }
        
        .explosion {
            animation: explode 0.6s forwards;
        }
        
        @keyframes explode {
            0% { transform: scale(0.5); opacity: 1; }
            50% { transform: scale(1.8); }
            100% { transform: scale(2.5); opacity: 0; }
        }
        
        .card-hover {
            transition: all 0.3s;
        }
        .card-hover:hover {
            transform: scale(1.02);
            box-shadow: 0 0 30px #ff00ff;
        }
        
        .reel {
            height: 180px;
            overflow: hidden;
            border: 4px solid #ffd700;
            background: #111;
        }

        .rocket-container {
            position: absolute;
            width: 60px;
            height: 60px;
            transition: bottom 0.1s linear, left 0.1s linear;
            z-index: 10;
        }

        .rocket-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transform: rotate(-45deg);
        }

        .locked-overlay {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(4px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: absolute;
            inset: 0;
            z-index: 20;
        }
    </style>
</head>
<body class="bg-zinc-950 text-white overflow-x-hidden">
    <header class="bg-black border-b-4 border-pink-500 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <img src="main.jpg" class="w-12 h-12 rounded-full border-2 border-pink-500 object-cover" alt="Logo">
                <div>
                    <h1 class="text-2xl font-bold neon-text tracking-widest">MEOWFLOPR</h1>
                    <p class="text-pink-400 text-[10px] -mt-1">CASINO</p>
                </div>
            </div>
            
            <div class="flex items-center gap-4 lg:gap-8">
                <nav class="hidden md:flex gap-8 text-xs">
                    <a onclick="showSection('home')" class="cursor-pointer hover:text-pink-400 transition">–ì–õ–ê–í–ù–ê–Ø</a>
                    <a onclick="showSection('games')" class="cursor-pointer hover:text-pink-400 transition">–ò–ì–†–´</a>
                    <a onclick="showBonus()" class="cursor-pointer hover:text-pink-400 transition">–ë–û–ù–£–°–´</a>
                </nav>
                
                <div class="flex flex-col items-end">
                     <div id="balance-display" class="bg-zinc-900 px-4 py-1 rounded-full border border-emerald-400 flex items-center gap-2 font-bold text-xs mb-1">
                        <span class="text-emerald-400">‚ÇΩ</span>
                        <span id="balance">100000</span>
                    </div>
                    <div class="text-[10px] text-yellow-400">LVL: <span id="level-display">1</span> (XP: <span id="xp-display">0</span>)</div>
                </div>

                <div onclick="showProfile()" class="flex items-center gap-2 cursor-pointer">
                    <div id="username-display" class="text-pink-400 text-xs hidden sm:block">–ò–ì–†–û–ö</div>
                    <div class="w-8 h-8 bg-pink-500 rounded-full flex items-center justify-center text-xs">üêæ</div>
                </div>
            </div>
        </div>
    </header>

    <section id="home" class="relative min-h-screen flex flex-col items-center pt-20 bg-[radial-gradient(at_center,#4c1d95_0%,#000_70%)]">
        <div class="text-center z-10 px-6 mb-16">
            <h2 class="text-4xl md:text-6xl font-bold neon-text mb-4">–î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨</h2>
            <h1 class="text-5xl md:text-8xl font-black tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-cyan-400">MEOWFLOPR</h1>
            
            <div class="mt-12 flex justify-center">
                <button onclick="showGames()" 
                        class="bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 px-10 py-4 text-xl font-bold rounded-xl border-4 border-white transition">
                    –ò–ì–†–ê–¢–¨ –°–ï–ô–ß–ê–°
                </button>
            </div>
        </div>

        <div class="w-full max-w-4xl px-6 z-10">
            <h3 class="text-2xl text-yellow-400 mb-6 text-center border-b-4 border-yellow-400 pb-2">–¢–û–ü –ë–û–ì–ê–¢–ï–ô–®–ò–•</h3>
            <div class="bg-zinc-900 border-4 border-purple-500 rounded-xl p-6">
                <div class="space-y-4">
                    <div class="flex justify-between items-center text-yellow-300 border-b border-zinc-700 pb-2">
                        <div class="flex items-center gap-4">
                            <span class="text-2xl">ü•á</span>
                            <span>MeowFlopr</span>
                        </div>
                        <span class="text-emerald-400">1488 –º–ª–Ω ‚ÇΩ</span>
                    </div>
                    <div class="flex justify-between items-center text-gray-300">
                        <div class="flex items-center gap-4">
                            <span class="text-xl">ü•à</span>
                            <span>ShadowKing</span>
                        </div>
                        <span class="text-emerald-400">500 –º–ª–Ω ‚ÇΩ</span>
                    </div>
                    <div class="flex justify-between items-center text-amber-600">
                        <div class="flex items-center gap-4">
                            <span class="text-xl">ü•â</span>
                            <span>LuckyDoge</span>
                        </div>
                        <span class="text-emerald-400">120 –º–ª–Ω ‚ÇΩ</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="games" class="max-w-7xl mx-auto px-6 py-16 hidden">
        <h2 class="text-4xl font-bold text-center mb-12 neon-text">–ò–ì–†–´</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div onclick="openSlotsModal()" 
                 class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-yellow-400 cursor-pointer relative">
                <img src="https://cdn.nur.kz/images/1200x675/36135d7df8b99f1afe63116c264a570c.jpeg?version=1" 
                     class="w-full h-60 object-cover">
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-2">–°–õ–û–¢–´ –ú–ï–õ–°–¢–†–û–Ø</h3>
                    <p class="text-zinc-400 text-xs mb-4">–ú–∏–Ω. —É—Ä–æ–≤–µ–Ω—å: 1</p>
                    <button class="w-full bg-yellow-400 text-black py-3 font-bold rounded-xl hover:bg-yellow-300 text-xs">
                        –ò–ì–†–ê–¢–¨
                    </button>
                </div>
            </div>
            
            <div onclick="openEpsteinModal()" 
                 class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-red-500 cursor-pointer relative group">
                <div id="lock-epstein" class="locked-overlay hidden">
                    <div class="text-4xl mb-2">üîí</div>
                    <div class="text-red-500 font-bold">–ù–£–ñ–ï–ù 5 –£–†–û–í–ï–ù–¨</div>
                </div>
                <img src="https://nypost.com/wp-content/uploads/sites/2/2019/08/jeffrey-epstein-2-3.jpg?quality=75&strip=all" 
                     class="w-full h-60 object-cover">
                <div class="p-6">
                    <h3 class="text-xl font-bold text-red-400 mb-2">–≠–ü–®–¢–ï–ô–ù</h3>
                    <p class="text-zinc-400 text-xs mb-4">–ú–∏–Ω. —É—Ä–æ–≤–µ–Ω—å: 5</p>
                    <button class="w-full bg-red-600 py-3 font-bold rounded-xl hover:bg-red-500 text-xs">
                        –†–ê–ó–ë–ò–†–ê–¢–¨–°–Ø
                    </button>
                </div>
            </div>

            <div onclick="openBeastModal()" 
                 class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-blue-500 cursor-pointer relative group">
                <div id="lock-beast" class="locked-overlay hidden">
                    <div class="text-4xl mb-2">üîí</div>
                    <div class="text-blue-500 font-bold">–ù–£–ñ–ï–ù 10 –£–†–û–í–ï–ù–¨</div>
                </div>
                <img src="mrbeast.jpg" class="w-full h-60 object-cover">
                <div class="p-6">
                    <h3 class="text-xl font-bold text-blue-400 mb-2">BEAST CRASH</h3>
                    <p class="text-zinc-400 text-xs mb-4">–ú–∏–Ω. —É—Ä–æ–≤–µ–Ω—å: 10</p>
                    <button class="w-full bg-blue-600 py-3 font-bold rounded-xl hover:bg-blue-500 text-xs">
                        –ü–û–õ–ï–¢–ï–õ–ò
                    </button>
                </div>
            </div>
        </div>
    </section>

    <div id="login-modal" class="fixed inset-0 bg-black/90 flex items-center justify-center hidden z-[100]">
        <div class="bg-zinc-900 border-4 border-pink-500 rounded-3xl p-8 max-w-sm w-full mx-4">
            <h2 class="text-2xl text-center mb-6">–ö–¢–û –¢–´?</h2>
            <input id="username-input" type="text" placeholder="–ù–ò–ö–ù–ï–ô–ú" 
                   class="w-full bg-black border-2 border-pink-400 px-4 py-3 text-sm focus:outline-none focus:border-pink-500 rounded-xl mb-4">
            <button onclick="login()" class="w-full bg-pink-500 hover:bg-pink-600 py-4 font-bold rounded-xl text-sm">–í–û–ô–¢–ò</button>
        </div>
    </div>

    <div id="slots-modal" class="fixed inset-0 bg-black/95 flex items-center justify-center hidden z-[100]">
        <div class="bg-zinc-950 border-4 border-yellow-400 rounded-3xl p-6 max-w-2xl w-full mx-4 relative">
            <button onclick="closeSlotsModal()" class="absolute top-4 right-4 text-2xl hover:text-red-500">‚úï</button>
            <h2 class="text-2xl text-center mb-6 text-yellow-400">–°–õ–û–¢–´</h2>
            
            <div class="flex justify-center gap-2 mb-8">
                <div id="reel1" class="reel w-24 md:w-32 flex items-center justify-center text-6xl"></div>
                <div id="reel2" class="reel w-24 md:w-32 flex items-center justify-center text-6xl"></div>
                <div id="reel3" class="reel w-24 md:w-32 flex items-center justify-center text-6xl"></div>
            </div>
            
            <div class="flex flex-wrap justify-center gap-2 mb-6" id="slots-bet-buttons">
                <button onclick="setBet(100)" class="px-4 py-2 bg-zinc-800 hover:bg-zinc-700 rounded text-xs">100</button>
                <button onclick="setBet(500)" class="px-4 py-2 bg-zinc-800 hover:bg-zinc-700 rounded text-xs">500</button>
                <button onclick="setBet(1000)" class="px-4 py-2 bg-zinc-800 hover:bg-zinc-700 rounded text-xs">1K</button>
            </div>

            <div class="mb-6 px-10">
                <input type="number" id="custom-bet-slots" placeholder="–°–≤–æ—è —Å—Ç–∞–≤–∫–∞ (Lvl 15+)" disabled
                       class="w-full bg-zinc-900 border border-zinc-700 p-3 rounded text-center text-xs disabled:opacity-50"
                       onchange="setCustomBet(this.value, 'slots')">
            </div>
            
            <div class="text-center">
                <div class="text-sm mb-4">–°–¢–ê–í–ö–ê: <span id="current-bet" class="text-yellow-400">1000</span> ‚ÇΩ</div>
                <button onclick="spin()" id="spin-button"
                        class="bg-yellow-400 text-black font-bold px-12 py-4 rounded-full hover:scale-105 active:scale-95 transition text-xl">
                    –ö–†–£–¢–ò–¢–¨
                </button>
            </div>
            <div id="slots-result" class="text-center text-lg mt-4 min-h-[30px] font-bold"></div>
        </div>
    </div>

    <div id="epstein-modal" class="fixed inset-0 bg-black/95 flex items-center justify-center hidden z-[100]">
        <div class="bg-zinc-950 border-4 border-red-600 rounded-3xl p-6 max-w-4xl w-full mx-4 h-[90vh] flex flex-col relative">
            <button onclick="closeEpsteinModal()" class="absolute top-4 right-4 text-2xl hover:text-red-500 z-10">‚úï</button>
            <h2 class="text-2xl text-center mb-4 text-red-400">–û–°–¢–†–û–í –≠–ü–®–¢–ï–ô–ù–ê</h2>
            
            <div class="flex flex-col md:flex-row gap-6 h-full overflow-y-auto">
                <div class="md:w-64 flex-shrink-0">
                    <div class="grid grid-cols-2 gap-2 mb-4">
                        <button onclick="setEpsteinBet(1000)" class="py-3 bg-zinc-800 rounded text-xs ep-btn">1K</button>
                        <button onclick="setEpsteinBet(5000)" class="py-3 bg-zinc-800 rounded text-xs ep-btn">5K</button>
                        <button onclick="setEpsteinBet(10000)" class="py-3 bg-zinc-800 rounded text-xs ep-btn">10K</button>
                        <button onclick="setEpsteinBet(50000)" class="py-3 bg-zinc-800 rounded text-xs ep-btn">50K</button>
                    </div>
                    
                    <input type="number" id="custom-bet-epstein" placeholder="–°–≤–æ—è —Å—Ç–∞–≤–∫–∞ (Lvl 15+)" disabled
                           class="w-full bg-zinc-900 border border-zinc-700 p-3 rounded text-center text-xs mb-4 disabled:opacity-50"
                           onchange="setCustomBet(this.value, 'epstein')">

                    <button onclick="startEpsteinGame()" id="start-epstein-btn"
                            class="w-full bg-red-600 py-4 font-bold rounded-xl text-sm mb-4">–ù–ê–ß–ê–¢–¨</button>
                    
                    <div id="epstein-stats" class="hidden">
                        <div class="text-center text-xs text-zinc-400 mb-1">–¢–ï–ö–£–©–ò–ô –í–´–ò–ì–†–´–®</div>
                        <div class="text-center text-xl text-emerald-400 font-bold mb-4"><span id="epstein-current-win">0</span> ‚ÇΩ</div>
                        <button onclick="cashOutEpstein()" class="w-full bg-emerald-500 text-black py-4 font-bold rounded-xl text-sm">–ó–ê–ë–†–ê–¢–¨</button>
                    </div>
                </div>
                
                <div class="flex-1 bg-zinc-900 rounded-xl p-4 flex items-center justify-center">
                    <div id="epstein-grid" class="grid grid-cols-4 gap-2 w-full max-w-[400px]"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="beast-modal" class="fixed inset-0 bg-black/95 flex items-center justify-center hidden z-[100]">
        <div class="bg-zinc-950 border-4 border-blue-500 rounded-3xl p-6 max-w-3xl w-full mx-4 relative">
            <button onclick="closeBeastModal()" class="absolute top-4 right-4 text-2xl hover:text-red-500 z-20">‚úï</button>
            <h2 class="text-2xl text-center mb-2 text-blue-400">MRBEAST CRASH</h2>
            
            <div class="relative w-full h-64 bg-zinc-900 rounded-xl border-2 border-blue-900 mb-6 overflow-hidden">
                <canvas id="beast-canvas" class="w-full h-full block"></canvas>
                <div id="crash-multiplier" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-5xl font-bold text-white z-0">1.00x</div>
                <div id="beast-message" class="absolute inset-0 flex items-center justify-center bg-black/60 hidden z-30">
                    <span class="text-red-500 text-3xl font-bold">CRASHED!</span>
                </div>
            </div>

            <div class="flex gap-4 items-end">
                <div class="flex-1">
                    <label class="text-xs text-zinc-400 block mb-2">–°–¢–ê–í–ö–ê</label>
                    <div class="flex gap-2 mb-2">
                        <button onclick="setBeastBet(1000)" class="flex-1 bg-zinc-800 py-2 rounded text-xs beast-bet-btn">1K</button>
                        <button onclick="setBeastBet(5000)" class="flex-1 bg-zinc-800 py-2 rounded text-xs beast-bet-btn">5K</button>
                        <button onclick="setBeastBet(10000)" class="flex-1 bg-zinc-800 py-2 rounded text-xs beast-bet-btn">10K</button>
                    </div>
                    <input type="number" id="custom-bet-beast" placeholder="–°–≤–æ—è —Å—Ç–∞–≤–∫–∞ (Lvl 15+)" disabled
                           class="w-full bg-zinc-900 border border-zinc-700 p-3 rounded text-center text-xs disabled:opacity-50"
                           onchange="setCustomBet(this.value, 'beast')">
                </div>
                <div class="w-40">
                    <button id="beast-action-btn" onclick="startBeastGame()" 
                            class="w-full h-full bg-blue-600 hover:bg-blue-500 font-bold rounded-xl text-lg py-4 transition">
                        –°–¢–ê–†–¢
                    </button>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-black py-8 border-t-4 border-pink-500 mt-12">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <p class="text-zinc-600 text-[10px]">MeowFlopr Casino &copy; 2026. –ü—Ä–æ—Å—Ç–æ —à—É—Ç–∫–∞.</p>
        </div>
    </footer>

    <script>
        let user = {
            username: "–ò–ì–†–û–ö",
            balance: 100000,
            xp: 0,
            level: 1
        }

        const symbols = [
            { name: "banana", url: "https://avatars.mds.yandex.net/get-mpic/5234083/img_id3506543352633991634.png/orig" },
            { name: "plum", url: "https://main-cdn.sbermegamarket.ru/big1/hlr-system/-90/257/429/371/118/48/100032397594b0.jpg" },
            { name: "grape", url: "https://avatars.mds.yandex.net/get-mpic/5145248/img_id4537599123360367823.png/orig" }
        ]

        let currentBet = 1000
        let epsteinBet = 1000
        let beastBet = 1000
        
        let epsteinWinnings = 0
        let epsteinActive = false
        
        let beastActive = false
        let beastMultiplier = 1.00
        let beastCrashPoint = 0
        let beastInterval = null
        let beastCashedOut = false

        function loadUser() {
            const saved = localStorage.getItem("meowflopr_user_v2")
            if (saved) {
                const parsed = JSON.parse(saved)
                user = { ...user, ...parsed } 
            }
            updateUI()
        }

        function saveUser() {
            localStorage.setItem("meowflopr_user_v2", JSON.stringify(user))
            updateUI()
        }

        function addXp(amount) {
            user.xp += Math.floor(amount)
            const newLevel = Math.floor(user.xp / 5000) + 1
            if (newLevel > user.level) {
                alert(`–£–†–û–í–ï–ù–¨ –ü–û–í–´–®–ï–ù! –¢–ï–ü–ï–†–¨ –¢–´ ${newLevel} LVL`)
                user.level = newLevel
            }
            saveUser()
        }

        function updateUI() {
            document.getElementById("balance").textContent = Math.floor(user.balance).toLocaleString("ru-RU")
            document.getElementById("username-display").textContent = user.username
            document.getElementById("level-display").textContent = user.level
            document.getElementById("xp-display").textContent = user.xp

            if (user.level >= 5) document.getElementById("lock-epstein").classList.add("hidden")
            else document.getElementById("lock-epstein").classList.remove("hidden")

            if (user.level >= 10) document.getElementById("lock-beast").classList.add("hidden")
            else document.getElementById("lock-beast").classList.remove("hidden")

            if (user.level >= 15) {
                document.getElementById("custom-bet-slots").disabled = false
                document.getElementById("custom-bet-epstein").disabled = false
                document.getElementById("custom-bet-beast").disabled = false
            }
        }

        function login() {
            const input = document.getElementById("username-input").value.trim()
            if (input) user.username = input.toUpperCase()
            saveUser()
            document.getElementById("login-modal").classList.add("hidden")
        }

        function showSection(section) {
            document.getElementById("home").classList.add("hidden")
            document.getElementById("games").classList.add("hidden")
            document.getElementById(section).classList.remove("hidden")
        }

        function showGames() { showSection("games") }

        function showProfile() {
            const newName = prompt("–°–º–µ–Ω–∏—Ç—å –Ω–∏–∫:", user.username)
            if (newName) { user.username = newName.toUpperCase(); saveUser(); }
        }

        function showBonus() {
            user.balance += 500
            alert("–ë–æ–Ω—É—Å +500—Ä –ø–æ–ª—É—á–µ–Ω!")
            saveUser()
        }

        function setCustomBet(val, game) {
            val = parseInt(val)
            if (isNaN(val) || val < 100) val = 100
            if (game === 'slots') { currentBet = val; document.getElementById("current-bet").textContent = val; }
            if (game === 'epstein') epsteinBet = val
            if (game === 'beast') beastBet = val
        }

        /* SLOTS */
        function openSlotsModal() {
            document.getElementById("slots-modal").classList.remove("hidden")
            resetReels()
        }
        function closeSlotsModal() { document.getElementById("slots-modal").classList.add("hidden") }
        function resetReels() {
            [1,2,3].forEach(i => document.getElementById(`reel${i}`).innerHTML = `<img src="${symbols[0].url}" class="w-20 object-contain">`)
        }
        function setBet(amt) { currentBet = amt; document.getElementById("current-bet").textContent = amt; }
        
        function spin() {
            if (user.balance < currentBet) { alert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥!"); return }
            
            user.balance -= currentBet
            addXp(currentBet * 0.1) 
            saveUser()
            
            const btn = document.getElementById("spin-button")
            btn.disabled = true
            document.getElementById("slots-result").innerHTML = ""
            
            const rand = Math.random() * 100
            let outcome = "loss"
            if (rand > 95) outcome = "jackpot" 
            else if (rand > 70) outcome = "win" 

            let finalSyms = []
            if (outcome === "jackpot") {
                const s = symbols[Math.floor(Math.random()*symbols.length)]
                finalSyms = [s, s, s]
            } else if (outcome === "win") {
                const s1 = symbols[Math.floor(Math.random()*symbols.length)]
                const s2 = symbols[Math.floor(Math.random()*symbols.length)]
                finalSyms = [s1, s1, s2] 
            } else {
                const s1 = symbols[0]
                const s2 = symbols[1]
                const s3 = symbols[2]
                finalSyms = [s1, s2, s3].sort(() => Math.random() - 0.5)
            }

            [1,2,3].forEach((r, i) => {
                const reel = document.getElementById(`reel${r}`)
                let count = 0
                const interval = setInterval(() => {
                    reel.innerHTML = `<img src="${symbols[Math.floor(Math.random()*3)].url}" class="w-20 object-contain">`
                    count++
                    if (count > 10 + i * 5) {
                        clearInterval(interval)
                        reel.innerHTML = `<img src="${finalSyms[i].url}" class="w-20 object-contain">`
                        if (i === 2) finalizeSlots(outcome)
                    }
                }, 80)
            })
        }

        function finalizeSlots(outcome) {
            const res = document.getElementById("slots-result")
            document.getElementById("spin-button").disabled = false
            
            if (outcome === "jackpot") {
                const win = currentBet * 10
                user.balance += win
                res.innerHTML = `<span class="text-emerald-400">–î–ñ–ï–ö–ü–û–¢! +${win}</span>`
            } else if (outcome === "win") {
                const win = Math.floor(currentBet * 2) 
                user.balance += win
                res.innerHTML = `<span class="text-emerald-400">–ü–û–ë–ï–î–ê +${win}</span>`
            } else {
                res.innerHTML = `<span class="text-red-500">–õ–£–ó</span>`
            }
            saveUser()
        }

        /* EPSTEIN */
        function openEpsteinModal() {
            if (user.level < 5) return
            document.getElementById("epstein-modal").classList.remove("hidden")
            resetEpsteinUI()
        }
        function closeEpsteinModal() { document.getElementById("epstein-modal").classList.add("hidden") }
        function setEpsteinBet(amt) { epsteinBet = amt; }
        
        function resetEpsteinUI() {
            epsteinActive = false
            epsteinWinnings = 0
            document.getElementById("epstein-stats").classList.add("hidden")
            document.getElementById("start-epstein-btn").classList.remove("hidden")
            document.getElementById("epstein-grid").innerHTML = ""
        }

        function startEpsteinGame() {
            if (user.balance < epsteinBet) { alert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥"); return }
            user.balance -= epsteinBet
            addXp(epsteinBet * 0.2)
            saveUser()

            epsteinActive = true
            epsteinWinnings = 0
            document.getElementById("start-epstein-btn").classList.add("hidden")
            document.getElementById("epstein-stats").classList.remove("hidden")
            document.getElementById("epstein-current-win").textContent = "0"
            
            const grid = document.getElementById("epstein-grid")
            grid.innerHTML = ""
            
            let types = Array(11).fill("safe").concat(Array(5).fill("bomb")).sort(()=>Math.random()-0.5)
            
            for(let i=0; i<16; i++) {
                const d = document.createElement("div")
                d.className = "aspect-square bg-zinc-800 rounded-lg flex items-center justify-center cursor-pointer hover:bg-zinc-700 transition border-2 border-zinc-700"
                d.innerHTML = "?"
                d.onclick = () => clickEpsteinCell(d, types[i])
                grid.appendChild(d)
            }
        }

        function clickEpsteinCell(el, type) {
            if (!epsteinActive || el.classList.contains("revealed")) return
            el.classList.add("revealed")
            
            if (type === "bomb") {
                el.innerHTML = "üí•"
                el.classList.add("bg-red-900", "border-red-500")
                epsteinActive = false
                setTimeout(() => { alert("–≠–ø—à—Ç–µ–π–Ω —Ç–µ–±—è –ø–æ–π–º–∞–ª!"); resetEpsteinUI(); }, 500)
            } else {
                const prize = Math.floor(Math.random() * 3500) + 1500 
                epsteinWinnings += prize
                document.getElementById("epstein-current-win").textContent = epsteinWinnings
                el.innerHTML = `<div class="text-[10px] text-emerald-400 font-bold">+${prize}</div>`
                el.classList.add("bg-zinc-900", "border-emerald-500")
            }
        }

        function cashOutEpstein() {
            if (!epsteinActive) return
            user.balance += epsteinWinnings
            saveUser()
            alert(`–í—ã–≤–µ–ª: ${epsteinWinnings} ‚ÇΩ`)
            resetEpsteinUI()
        }

        /* MRBEAST CRASH */
        function openBeastModal() {
            if (user.level < 10) return
            document.getElementById("beast-modal").classList.remove("hidden")
            resetBeastGame()
        }
        function closeBeastModal() { 
            document.getElementById("beast-modal").classList.add("hidden") 
            if(beastInterval) clearInterval(beastInterval)
        }
        function setBeastBet(amt) { beastBet = amt }

        function resetBeastGame() {
            const canvas = document.getElementById("beast-canvas")
            const ctx = canvas.getContext("2d")
            ctx.clearRect(0,0,canvas.width,canvas.height)
            document.getElementById("crash-multiplier").textContent = "1.00x"
            document.getElementById("crash-multiplier").classList.remove("text-red-500")
            document.getElementById("crash-multiplier").classList.add("text-white")
            document.getElementById("beast-message").classList.add("hidden")
            
            const btn = document.getElementById("beast-action-btn")
            btn.textContent = "–°–¢–ê–†–¢"
            btn.classList.remove("bg-emerald-500", "hover:bg-emerald-400")
            btn.classList.add("bg-blue-600", "hover:bg-blue-500")
            btn.disabled = false
            
            beastActive = false
            beastCashedOut = false
        }

        function startBeastGame() {
            if (beastActive) {
                // –≠—Ç–æ –Ω–∞–∂–∞—Ç–∏–µ "–ó–∞–±—Ä–∞—Ç—å"
                cashOutBeast()
                return
            }

            if (user.balance < beastBet) { alert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥"); return }
            user.balance -= beastBet
            addXp(beastBet * 0.3)
            saveUser()

            beastActive = true
            beastCashedOut = false
            beastMultiplier = 1.00
            beastCrashPoint = (Math.random() * 5) + 1 
            if (Math.random() > 0.9) beastCrashPoint = 10 + Math.random() * 20 
            if (Math.random() < 0.3) beastCrashPoint = 1.0 + Math.random() * 0.2 // –†–∞–Ω–Ω–∏–π –∫—Ä–∞—à

            const btn = document.getElementById("beast-action-btn")
            btn.textContent = "–ó–ê–ë–†–ê–¢–¨"
            btn.classList.remove("bg-blue-600", "hover:bg-blue-500")
            btn.classList.add("bg-emerald-500", "hover:bg-emerald-400")

            runBeastLoop()
        }

        function runBeastLoop() {
            const canvas = document.getElementById("beast-canvas")
            const ctx = canvas.getContext("2d")
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ canvas —Ä–∞–∑–º–µ—Ä–∞
            canvas.width = canvas.offsetWidth
            canvas.height = canvas.offsetHeight
            
            let startTime = Date.now()
            const rocketImg = new Image()
            rocketImg.src = "raketmrbeast.jpg"

            beastInterval = setInterval(() => {
                if (!beastActive) { clearInterval(beastInterval); return }

                const elapsed = (Date.now() - startTime) / 1000
                beastMultiplier = 1 + (elapsed * elapsed * 0.1)
                
                document.getElementById("crash-multiplier").textContent = beastMultiplier.toFixed(2) + "x"

                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
                ctx.clearRect(0, 0, canvas.width, canvas.height)
                ctx.strokeStyle = "#3b82f6"
                ctx.lineWidth = 3
                ctx.beginPath()
                ctx.moveTo(0, canvas.height)
                
                // –ü—Ä–æ—Å—Ç–∞—è –∫—Ä–∏–≤–∞—è
                const x = Math.min(canvas.width - 50, elapsed * 40)
                const y = canvas.height - Math.min(canvas.height - 50, (beastMultiplier - 1) * 80)
                
                ctx.lineTo(x, y)
                ctx.stroke()
                
                if (rocketImg.complete) {
                    ctx.save()
                    ctx.translate(x, y)
                    ctx.rotate(-0.5)
                    ctx.drawImage(rocketImg, -20, -20, 40, 40)
                    ctx.restore()
                }

                if (beastMultiplier >= beastCrashPoint) {
                    crashBeast()
                }
            }, 30)
        }

        function crashBeast() {
            clearInterval(beastInterval)
            beastActive = false
            document.getElementById("crash-multiplier").classList.add("text-red-500")
            document.getElementById("beast-message").classList.remove("hidden")
            
            const btn = document.getElementById("beast-action-btn")
            btn.textContent = "–ï–©–Å –†–ê–ó"
            btn.classList.remove("bg-emerald-500", "hover:bg-emerald-400")
            btn.classList.add("bg-blue-600", "hover:bg-blue-500")
            btn.onclick = () => resetBeastGame()
        }

        function cashOutBeast() {
            if (!beastActive || beastCashedOut) return
            beastCashedOut = true
            beastActive = false
            clearInterval(beastInterval)
            
            const win = Math.floor(beastBet * beastMultiplier)
            user.balance += win
            saveUser()
            alert(`–£—Å–ø–µ—Ö! –í—ã–≤–µ–ª ${win} ‚ÇΩ (x${beastMultiplier.toFixed(2)})`)
            resetBeastGame()
        }

        window.onload = function() {
            loadUser()
            if (!localStorage.getItem("meowflopr_user_v2")) {
                document.getElementById("login-modal").classList.remove("hidden")
            }
            showSection("home")
        }
    </script>
</body>
</html>
