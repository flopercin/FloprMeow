<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MeowFlopr Casino</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            font-family: 'Press Start 2P', system-ui;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #ec4899; border-radius: 4px; }

        .neon-text {
            text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes fadeOut {
            to { transform: translateX(100%); opacity: 0; }
        }
        .toast-enter { animation: slideIn 0.4s forwards; }
        .toast-exit { animation: fadeOut 0.4s forwards; }

        .slot-reel { transition: all 0.1s linear; }
        
        .card-hover { transition: all 0.3s; }
        .card-hover:active { transform: scale(0.95); }
        @media (min-width: 768px) {
            .card-hover:hover {
                transform: scale(1.05) rotate(2deg);
                box-shadow: 0 0 30px #ff00ff;
                z-index: 10;
            }
        }

        .locked-game {
            filter: grayscale(100%);
            pointer-events: none;
            position: relative;
        }
        
        .reel {
            height: 120px;
            overflow: hidden;
            border: 4px solid #ffd700;
            background: #111;
        }
        @media (min-width: 768px) { .reel { height: 180px; } }
    </style>
</head>
<body class="bg-zinc-950 text-white overflow-x-hidden selection:bg-pink-500 selection:text-white">

    <div id="toast-container" class="fixed top-4 right-4 z-[200] flex flex-col gap-3 w-full max-w-[320px] px-4 pointer-events-none"></div>

    <header class="bg-black border-b-4 border-pink-500 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-3 flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-3 w-full md:w-auto justify-between md:justify-start">
                <div class="flex items-center gap-3">
                    <img src="main.jpg" onerror="this.src='https://placehold.co/100x100/ff00ff/ffffff?text=MF'" alt="MeowFlopr" class="w-10 h-10 object-cover rounded-xl border-2 border-pink-500">
                    <div>
                        <h1 class="text-xl md:text-3xl font-bold neon-text tracking-widest">MEOWFLOPR</h1>
                    </div>
                </div>
                <div class="md:hidden flex items-center gap-2 bg-zinc-900 px-3 py-1 rounded-full border border-emerald-400 text-xs">
                    <span class="text-emerald-400">‚ÇΩ</span>
                    <span id="balance-mobile">0</span>
                </div>
            </div>
            
            <div class="flex flex-col md:flex-row items-center gap-4 w-full md:w-auto">
                <nav class="flex gap-4 text-[10px] md:text-sm w-full justify-between md:justify-start overflow-x-auto pb-1 md:pb-0">
                    <a onclick="showSection('home')" class="cursor-pointer hover:text-pink-400 whitespace-nowrap">–ì–õ–ê–í–ù–ê–Ø</a>
                    <a onclick="showSection('games')" class="cursor-pointer hover:text-pink-400 whitespace-nowrap">–ò–ì–†–´</a>
                    <a onclick="showLeaderboard()" class="cursor-pointer hover:text-pink-400 whitespace-nowrap">–¢–û–ü</a>
                    <a onclick="showBonus()" class="cursor-pointer hover:text-pink-400 whitespace-nowrap text-yellow-400 animate-pulse">–ë–û–ù–£–°</a>
                </nav>
                
                <div class="hidden md:flex items-center gap-6">
                    <div class="bg-zinc-900 px-6 py-2 rounded-full border-2 border-emerald-400 flex items-center gap-2 font-bold">
                        <span class="text-emerald-400">‚ÇΩ</span>
                        <span id="balance">100000</span>
                    </div>
                    <div class="bg-zinc-900 px-5 py-2 rounded-full border border-purple-400 flex items-center gap-2 cursor-pointer hover:bg-zinc-800" onclick="showLevelInfo()">
                        <span class="text-purple-400">LVL</span>
                        <span id="user-level" class="font-bold text-purple-400">1</span>
                    </div>
                </div>
                
                <div onclick="showProfile()" class="hidden md:flex items-center gap-2 cursor-pointer hover:opacity-80">
                    <div id="username-display" class="text-pink-400 text-sm truncate max-w-[100px]">–ò–ì–†–û–ö</div>
                    <div class="w-8 h-8 bg-pink-500 rounded-full flex items-center justify-center text-sm">üêæ</div>
                </div>
            </div>
        </div>
    </header>

    <section id="home" class="relative min-h-[calc(100vh-80px)] flex items-center justify-center bg-[radial-gradient(at_center,#4c1d95_0%,#000_70%)] py-10">
        <div class="text-center z-10 px-4 w-full max-w-4xl">
            <h2 class="text-2xl md:text-5xl font-bold neon-text mb-4">–î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨ –í</h2>
            <h1 class="text-4xl md:text-8xl font-black tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-cyan-400 mb-6 break-words">MEOWFLOPR</h1>
            <p class="text-xs md:text-2xl mt-4 text-pink-300 leading-relaxed">–ì–¥–µ –∫–∞–∂–¥—ã–π —Å–ø–∏–Ω ‚Äî —ç—Ç–æ –∫–æ—Ç –≤ –º–µ—à–∫–µ... —Å –¥–µ–Ω—å–≥–∞–º–∏</p>
            
            <div class="mt-12 flex justify-center">
                <button onclick="showGames()" class="w-full md:w-auto bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 px-8 py-6 text-xl md:text-2xl font-bold rounded-xl border-4 border-white transition shadow-[0_0_30px_#ec4899]">
                    –ò–ì–†–ê–¢–¨ –°–ï–ô–ß–ê–°
                </button>
            </div>
            
            <div class="mt-8 text-[10px] text-zinc-500">
                –ü–æ–º–Ω–∏: –∫–∞–∑–∏–Ω–æ –≤—Å–µ–≥–¥–∞ –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç (–Ω–æ –Ω–µ –∑–¥–µ—Å—å)
            </div>
        </div>
    </section>

    <section id="games" class="max-w-7xl mx-auto px-4 py-10 hidden pb-24">
        <h2 class="text-3xl md:text-5xl font-bold text-center mb-8 neon-text">–ò–ì–†–´</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-10">
            <div id="game-card-slots" class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-yellow-400 cursor-pointer relative" onclick="openSlotsModal()">
                <div class="lock-overlay absolute inset-0 bg-black/80 z-20 flex flex-col items-center justify-center hidden">
                    <i class="fas fa-lock text-6xl text-zinc-500 mb-4"></i>
                    <p class="text-zinc-400">–ù—É–∂–µ–Ω 1 —É—Ä–æ–≤–µ–Ω—å</p>
                </div>
                <img src="https://cdn.nur.kz/images/1200x675/36135d7df8b99f1afe63116c264a570c.jpeg?version=1" onerror="this.src='https://placehold.co/600x400/111/yellow?text=SLOTS'" class="w-full h-48 md:h-80 object-cover">
                <div class="p-6">
                    <h3 class="text-xl md:text-3xl font-bold mb-2">–°–õ–û–¢–´</h3>
                    <p class="text-emerald-400 text-xs md:text-lg mb-4">–ö–ª–∞—Å—Å–∏–∫–∞ –∂–∞–Ω—Ä–∞</p>
                    <div class="flex justify-between items-center">
                        <span class="text-yellow-400 text-xs">LVL 1+</span>
                        <button class="bg-yellow-400 text-black px-6 py-2 font-bold rounded-xl hover:bg-yellow-300 text-sm">–ò–ì–†–ê–¢–¨</button>
                    </div>
                </div>
            </div>
            
            <div id="game-card-epstein" class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-red-500 cursor-pointer relative" onclick="openEpsteinModal()">
                <div id="lock-epstein" class="lock-overlay absolute inset-0 bg-black/80 z-20 flex flex-col items-center justify-center">
                    <i class="fas fa-lock text-6xl text-zinc-500 mb-4"></i>
                    <p class="text-red-500 font-bold">–ù–£–ñ–ï–ù 5 –£–†–û–í–ï–ù–¨</p>
                </div>
                <img src="https://nypost.com/wp-content/uploads/sites/2/2019/08/jeffrey-epstein-2-3.jpg?quality=75&strip=all" onerror="this.src='https://placehold.co/600x400/111/red?text=EPSTEIN'" class="w-full h-48 md:h-80 object-cover">
                <div class="p-6">
                    <h3 class="text-xl md:text-3xl font-bold text-red-400 mb-2">EPSTEIN ISLAND</h3>
                    <p class="text-amber-400 text-xs md:text-lg mb-4">–ú–∏–Ω–Ω–æ–µ –ø–æ–ª–µ</p>
                    <div class="flex justify-between items-center">
                        <span class="text-red-400 text-xs">LVL 5+</span>
                        <button class="bg-red-600 px-6 py-2 font-bold rounded-xl hover:bg-red-500 text-sm">–ò–ì–†–ê–¢–¨</button>
                    </div>
                </div>
            </div>
            
            <div id="game-card-crash" class="card-hover bg-zinc-900 rounded-3xl overflow-hidden border-4 border-cyan-400 cursor-pointer relative" onclick="openMrBeastModal()">
                <div id="lock-crash" class="lock-overlay absolute inset-0 bg-black/80 z-20 flex flex-col items-center justify-center">
                    <i class="fas fa-lock text-6xl text-zinc-500 mb-4"></i>
                    <p class="text-cyan-500 font-bold">–ù–£–ñ–ï–ù 10 –£–†–û–í–ï–ù–¨</p>
                </div>
                <img src="mrbeast.jpg" onerror="this.src='https://placehold.co/600x400/111/cyan?text=CRASH'" class="w-full h-48 md:h-80 object-cover">
                <div class="p-6">
                    <h3 class="text-xl md:text-3xl font-bold text-cyan-400 mb-2">BEAST CRASH</h3>
                    <p class="text-sky-400 text-xs md:text-lg mb-4">–£—Å–ø–µ–π –∑–∞–±—Ä–∞—Ç—å!</p>
                    <div class="flex justify-between items-center">
                        <span class="text-cyan-400 text-xs">LVL 10+</span>
                        <button class="bg-cyan-500 text-black px-6 py-2 font-bold rounded-xl hover:bg-cyan-400 text-sm">–õ–ï–¢–ï–¢–¨</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="slots-modal" class="fixed inset-0 bg-black/90 flex items-center justify-center hidden z-[100] p-4">
        <div class="bg-zinc-950 border-4 border-yellow-400 rounded-3xl p-4 md:p-8 max-w-4xl w-full max-h-full overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl md:text-4xl text-yellow-400">–°–õ–û–¢–´</h2>
                <button onclick="closeSlotsModal()" class="text-2xl hover:text-white p-2">‚úï</button>
            </div>
            
            <div class="flex justify-center gap-2 md:gap-4 mb-8 bg-zinc-900 p-4 rounded-2xl border-2 border-zinc-800">
                <div id="reel1" class="reel w-20 md:w-40 flex items-center justify-center text-4xl md:text-8xl bg-black"></div>
                <div id="reel2" class="reel w-20 md:w-40 flex items-center justify-center text-4xl md:text-8xl bg-black"></div>
                <div id="reel3" class="reel w-20 md:w-40 flex items-center justify-center text-4xl md:text-8xl bg-black"></div>
            </div>
            
            <div class="grid grid-cols-3 md:flex md:justify-center gap-2 mb-6">
                <button onclick="setBet(100)" class="bet-btn p-2 md:px-6 md:py-3 bg-zinc-800 hover:bg-zinc-700 rounded-xl text-[10px] md:text-base">100‚ÇΩ</button>
                <button onclick="setBet(500)" class="bet-btn p-2 md:px-6 md:py-3 bg-zinc-800 hover:bg-zinc-700 rounded-xl text-[10px] md:text-base">500‚ÇΩ</button>
                <button onclick="setBet(1000)" class="bet-btn p-2 md:px-6 md:py-3 bg-zinc-800 hover:bg-zinc-700 rounded-xl text-[10px] md:text-base">1–ö‚ÇΩ</button>
                <button onclick="setBet(5000)" class="bet-btn p-2 md:px-6 md:py-3 bg-zinc-800 hover:bg-zinc-700 rounded-xl text-[10px] md:text-base">5–ö‚ÇΩ</button>
                <button onclick="showCustomBet('slots')" class="col-span-2 md:col-span-1 p-2 md:px-6 bg-purple-900 hover:bg-purple-800 rounded-xl text-[10px] md:text-base">–°–í–û–Ø</button>
            </div>

            <div id="custom-bet-slots" class="hidden flex gap-2 justify-center mb-4">
                <input id="input-slots" type="number" class="bg-black border border-purple-500 p-2 rounded w-32 text-center" placeholder="–°—É–º–º–∞">
                <button onclick="applyCustomBet('slots')" class="bg-purple-600 px-4 rounded">OK</button>
            </div>
            
            <div class="text-center">
                <div class="text-sm md:text-2xl mb-4 text-zinc-400">–°–¢–ê–í–ö–ê: <span id="current-bet" class="text-white font-bold">1000</span> ‚ÇΩ</div>
                <button onclick="spinSlots()" id="spin-button" class="w-full md:w-auto bg-gradient-to-b from-yellow-400 to-yellow-600 text-black text-xl md:text-4xl font-bold px-12 py-6 rounded-2xl shadow-[0_5px_0_#b45309] active:translate-y-1 active:shadow-none transition">–ö–†–£–¢–ò–¢–¨</button>
            </div>
            
            <div id="slots-result" class="text-center text-lg md:text-3xl mt-6 h-10 font-bold"></div>
        </div>
    </div>

    <div id="epstein-modal" class="fixed inset-0 bg-black/90 flex items-center justify-center hidden z-[100] p-4">
        <div class="bg-zinc-950 border-4 border-red-600 rounded-3xl p-4 md:p-8 max-w-5xl w-full max-h-full overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg md:text-3xl text-red-400">EPSTEIN ISLAND</h2>
                <button onclick="closeEpsteinModal()" class="text-2xl hover:text-red-400 p-2">‚úï</button>
            </div>
            
            <div class="flex flex-col md:flex-row gap-6">
                <div class="w-full md:w-64 flex flex-col gap-4 order-2 md:order-1">
                    <div class="bg-zinc-900 p-4 rounded-2xl border border-zinc-800">
                        <div class="text-xs text-zinc-500 mb-2">–°–¢–ê–í–ö–ê</div>
                        <input id="epstein-bet-input" type="number" value="1000" class="w-full bg-black border border-zinc-700 p-3 rounded-xl text-center text-xl mb-2">
                        <div class="grid grid-cols-2 gap-2 mb-4">
                            <button onclick="setEpsteinBetInput(1000)" class="bg-zinc-800 py-2 rounded text-xs">1K</button>
                            <button onclick="setEpsteinBetInput(5000)" class="bg-zinc-800 py-2 rounded text-xs">5K</button>
                            <button onclick="setEpsteinBetInput(10000)" class="bg-zinc-800 py-2 rounded text-xs">10K</button>
                            <button onclick="setEpsteinBetInput(user.balance)" class="bg-zinc-800 py-2 rounded text-xs text-pink-400">ALL</button>
                        </div>
                        <button onclick="startEpsteinGame()" id="start-epstein-btn" class="w-full bg-red-600 hover:bg-red-500 py-4 font-bold rounded-xl shadow-[0_4px_0_#991b1b] active:translate-y-1 active:shadow-none">–ù–ê–ß–ê–¢–¨</button>
                    </div>

                    <div id="epstein-stats" class="hidden">
                        <div class="text-center mb-2">
                            <div class="text-xs text-zinc-500">–¢–ï–ö–£–©–ò–ô –í–´–ò–ì–†–´–®</div>
                            <div class="text-2xl text-emerald-400 font-bold" id="ep-current-win">0 ‚ÇΩ</div>
                        </div>
                        <button onclick="cashOutEpstein()" class="w-full bg-emerald-500 hover:bg-emerald-400 text-black py-4 font-bold rounded-xl shadow-[0_4px_0_#065f46] active:translate-y-1 active:shadow-none">–ó–ê–ë–†–ê–¢–¨</button>
                    </div>
                </div>
                
                <div class="flex-1 order-1 md:order-2">
                    <div id="epstein-grid" class="grid grid-cols-4 gap-2 md:gap-3 bg-zinc-900 p-4 rounded-3xl border-2 border-zinc-800">
                        </div>
                </div>
            </div>
        </div>
    </div>

    <div id="mrbeast-modal" class="fixed inset-0 bg-black/90 flex items-center justify-center hidden z-[100] p-2">
        <div class="bg-zinc-950 border-4 border-cyan-500 rounded-3xl p-4 md:p-6 max-w-4xl w-full flex flex-col gap-4 relative overflow-hidden">
            <button onclick="closeMrBeastModal()" class="absolute top-4 right-4 text-zinc-500 hover:text-white z-20 text-2xl">‚úï</button>
            
            <div class="relative h-[250px] md:h-[400px] bg-zinc-900 rounded-2xl border-2 border-zinc-800 overflow-hidden">
                <canvas id="crash-canvas" class="absolute inset-0 w-full h-full z-0"></canvas>
                
                <div class="absolute inset-0 flex items-center justify-center z-10 pointer-events-none">
                    <div id="crash-multiplier-display" class="text-5xl md:text-8xl font-black text-white drop-shadow-md">1.00x</div>
                </div>
                
                <div id="crash-status" class="absolute inset-0 bg-black/80 flex flex-col items-center justify-center z-20 hidden">
                    <h2 class="text-red-500 text-4xl md:text-6xl font-black mb-2">CRASHED</h2>
                    <p class="text-zinc-400 text-xl" id="crashed-at-val">@ 1.00x</p>
                </div>
            </div>
            
            <div class="flex flex-col md:flex-row gap-4">
                <div class="flex-1 flex gap-2">
                    <input id="crash-bet-input" type="number" placeholder="–°—Ç–∞–≤–∫–∞" value="1000" class="bg-black border border-zinc-600 rounded-xl px-4 text-xl w-full">
                    <div class="flex gap-1">
                        <button onclick="halfCrashBet()" class="bg-zinc-800 px-3 rounded-xl text-xs">1/2</button>
                        <button onclick="doubleCrashBet()" class="bg-zinc-800 px-3 rounded-xl text-xs">x2</button>
                    </div>
                </div>
                
                <button id="crash-action-btn" onclick="startCrash()" class="w-full md:w-64 bg-cyan-500 hover:bg-cyan-400 text-black text-2xl font-black py-4 rounded-xl shadow-[0_5px_0_#0e7490] active:translate-y-1 active:shadow-none transition">
                    –°–¢–ê–†–¢
                </button>
            </div>
        </div>
    </div>

    <div id="login-modal" class="fixed inset-0 bg-black/95 flex items-center justify-center hidden z-[300] p-4">
        <div class="bg-zinc-900 border-2 border-pink-500 rounded-2xl p-8 w-full max-w-md text-center">
            <h2 class="text-2xl mb-6">–ö–¢–û –¢–´, –í–û–ò–ù?</h2>
            <input id="username-input" type="text" placeholder="–¢–≤–æ–π –Ω–∏–∫" class="w-full bg-black border border-zinc-600 p-4 text-center text-xl rounded-xl mb-4 text-white">
            <button onclick="login()" class="w-full bg-pink-600 py-4 font-bold rounded-xl">–ü–û–ì–ù–ê–õ–ò</button>
        </div>
    </div>
    
    <div id="leaderboard-modal" class="fixed inset-0 bg-black/80 flex items-center justify-center hidden z-[150] p-4">
        <div class="bg-zinc-900 border border-zinc-700 rounded-3xl p-6 max-w-md w-full">
            <h2 class="text-2xl text-center mb-6">–¢–û–ü –ë–û–ì–ê–¢–ï–ï–í</h2>
            <div class="space-y-4" id="leaderboard-list">
                </div>
            <button onclick="document.getElementById('leaderboard-modal').classList.add('hidden')" class="mt-6 w-full py-3 bg-zinc-800 rounded-xl">–ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <script>
        // === CORE SYSTEM ===
        let user = { username: "–ò–ì–†–û–ö", balance: 5000, level: 1, xp: 0 };
        
        function init() {
            const saved = localStorage.getItem("mf_user_v2");
            if (saved) user = JSON.parse(saved);
            
            if (!user.username || user.username === "–ò–ì–†–û–ö") {
                document.getElementById("login-modal").classList.remove("hidden");
            }
            
            updateUI();
            updateLocks();
            showSection('home');
        }

        function save() {
            localStorage.setItem("mf_user_v2", JSON.stringify(user));
        }

        function updateUI() {
            document.getElementById("balance").textContent = Math.floor(user.balance).toLocaleString();
            document.getElementById("balance-mobile").textContent = Math.floor(user.balance).toLocaleString();
            document.getElementById("user-level").textContent = user.level;
            document.getElementById("username-display").textContent = user.username;
        }

        function updateLocks() {
            // Logic for visual locks
            const games = [
                { id: 'game-card-slots', lvl: 1, lockId: null }, // Slots always open
                { id: 'game-card-epstein', lvl: 5, lockId: 'lock-epstein' },
                { id: 'game-card-crash', lvl: 10, lockId: 'lock-crash' }
            ];

            games.forEach(g => {
                const card = document.getElementById(g.id);
                const lock = g.lockId ? document.getElementById(g.lockId) : null;
                
                if (user.level < g.lvl) {
                    card.classList.add("locked-game");
                    if (lock) lock.classList.remove("hidden");
                    if (lock) lock.classList.add("flex");
                } else {
                    card.classList.remove("locked-game");
                    if (lock) lock.classList.add("hidden");
                    if (lock) lock.classList.remove("flex");
                }
            });
        }

        function addXp(amount) {
            user.xp += amount;
            const needed = user.level * 5000;
            if (user.xp >= needed) {
                user.level++;
                user.xp -= needed;
                showNotify(`–£–†–û–í–ï–ù–¨ –ü–û–í–´–®–ï–ù! –¢–ï–ü–ï–†–¨ ${user.level}`, "gold");
                updateLocks();
            }
            save();
            updateUI();
        }

        function login() {
            const val = document.getElementById("username-input").value.trim();
            if (val) user.username = val;
            document.getElementById("login-modal").classList.add("hidden");
            save();
            updateUI();
            showNotify(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${user.username}!`, "pink");
        }

        // === NOTIFICATION SYSTEM ===
        function showNotify(msg, type = "purple") {
            const container = document.getElementById("toast-container");
            const toast = document.createElement("div");
            
            // Colors
            let borderColor = "border-pink-500";
            let bg = "bg-zinc-900";
            let icon = "fa-bell";
            
            if (type === "success") { borderColor = "border-emerald-400"; icon = "fa-check"; }
            if (type === "error") { borderColor = "border-red-500"; icon = "fa-triangle-exclamation"; }
            if (type === "gold") { borderColor = "border-yellow-400"; icon = "fa-trophy"; }

            toast.className = `toast-enter pointer-events-auto flex items-center gap-3 p-4 rounded-xl border-l-4 ${borderColor} ${bg} shadow-lg text-sm md:text-base`;
            toast.innerHTML = `
                <i class="fas ${icon} ${type === 'error' ? 'text-red-500' : 'text-white'}"></i>
                <div class="font-bold">${msg}</div>
            `;
            
            container.appendChild(toast);
            
            // Auto remove
            setTimeout(() => {
                toast.classList.remove("toast-enter");
                toast.classList.add("toast-exit");
                setTimeout(() => toast.remove(), 400);
            }, 3000);
        }

        // === NAVIGATION ===
        function showSection(id) {
            document.getElementById("home").classList.add("hidden");
            document.getElementById("games").classList.add("hidden");
            document.getElementById(id).classList.remove("hidden");
        }
        function showGames() { showSection("games"); }
        
        function showBonus() {
            const now = Date.now();
            const last = user.lastBonus || 0;
            if (now - last < 60000) {
                const wait = Math.ceil((60000 - (now - last))/1000);
                showNotify(`–ë–æ–Ω—É—Å –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ ${wait} —Å–µ–∫`, "error");
                return;
            }
            user.balance += 500;
            user.lastBonus = now;
            save();
            updateUI();
            showNotify("+500 ‚ÇΩ –ë–æ–Ω—É—Å –ø–æ–ª—É—á–µ–Ω!", "success");
        }

        function showLeaderboard() {
            document.getElementById("leaderboard-modal").classList.remove("hidden");
            const list = document.getElementById("leaderboard-list");
            list.innerHTML = `
                <div class="flex justify-between border-b border-zinc-700 pb-2">
                    <span>1. MeowFlopr (Dev)</span>
                    <span class="text-yellow-400">‚àû</span>
                </div>
                <div class="flex justify-between border-b border-zinc-700 pb-2">
                    <span>2. ${user.username} (–¢—ã)</span>
                    <span class="text-emerald-400">${Math.floor(user.balance)}</span>
                </div>
                <div class="flex justify-between text-zinc-500">
                    <span>3. –õ–æ—Ö –ü–µ–¥–∞–ª—å–Ω—ã–π</span>
                    <span>0</span>
                </div>
            `;
        }

        // === SLOTS GAME ===
        let slotsBet = 1000;
        const slotSymbols = [
            {img: 'https://cdn-icons-png.flaticon.com/512/11699/11699946.png', val: 2}, // Cherry
            {img: 'https://cdn-icons-png.flaticon.com/512/3257/3257762.png', val: 3}, // Lemon
            {img: 'https://cdn-icons-png.flaticon.com/512/15570/15570196.png', val: 5}, // 777
            {img: 'https://cdn-icons-png.flaticon.com/512/625/625345.png', val: 10} // Diamond
        ];

        function openSlotsModal() {
            document.getElementById("slots-modal").classList.remove("hidden");
            resetSlots();
        }
        function closeSlotsModal() { document.getElementById("slots-modal").classList.add("hidden"); }
        function setBet(v) { slotsBet = v; document.getElementById("current-bet").textContent = v; }
        function showCustomBet(g) {
            const el = document.getElementById(`custom-bet-${g}`);
            el.classList.toggle("hidden");
        }
        function applyCustomBet(g) {
            const val = parseInt(document.getElementById(`input-${g}`).value);
            if(val > 0) {
                if(g === 'slots') setBet(val);
                document.getElementById(`custom-bet-${g}`).classList.add("hidden");
            }
        }
        
        function resetSlots() {
             [1,2,3].forEach(i => document.getElementById(`reel${i}`).innerHTML = `<img src="${slotSymbols[2].img}" class="w-16 md:w-24">`);
             document.getElementById("slots-result").innerHTML = "";
        }

        function spinSlots() {
            if(user.balance < slotsBet) return showNotify("–ù–µ—Ç –¥–µ–Ω–µ–≥!", "error");
            
            user.balance -= slotsBet;
            updateUI();
            
            const btn = document.getElementById("spin-button");
            btn.disabled = true;
            btn.classList.add("opacity-50");
            document.getElementById("slots-result").innerHTML = "";

            let results = [];
            [1,2,3].forEach((id, idx) => {
                const reel = document.getElementById(`reel${id}`);
                let count = 0;
                const interval = setInterval(() => {
                    const r = slotSymbols[Math.floor(Math.random()*slotSymbols.length)];
                    reel.innerHTML = `<img src="${r.img}" class="w-16 md:w-24 blur-sm">`;
                    count++;
                    if(count > 10 + idx*5) {
                        clearInterval(interval);
                        const final = slotSymbols[Math.floor(Math.random()*slotSymbols.length)];
                        reel.innerHTML = `<img src="${final.img}" class="w-16 md:w-24">`;
                        results.push(final);
                        if(results.length === 3) checkSlotsWin(results);
                    }
                }, 80);
            });
        }

        function checkSlotsWin(res) {
            const btn = document.getElementById("spin-button");
            btn.disabled = false;
            btn.classList.remove("opacity-50");
            
            const div = document.getElementById("slots-result");
            if(res[0].val === res[1].val && res[1].val === res[2].val) {
                const win = slotsBet * res[0].val * 2; // Jackpot
                user.balance += win;
                addXp(win/10);
                div.innerHTML = `<span class="text-yellow-400">JACKPOT! +${win}</span>`;
                showNotify(`–î–ñ–ï–ö–ü–û–¢ +${win} ‚ÇΩ`, "gold");
            } else if (res[0].val === res[1].val || res[1].val === res[2].val || res[0].val === res[2].val) {
                const win = Math.floor(slotsBet * 1.5);
                user.balance += win;
                addXp(win/20);
                div.innerHTML = `<span class="text-emerald-400">WIN! +${win}</span>`;
                showNotify(`–ü–æ–±–µ–¥–∞ +${win} ‚ÇΩ`, "success");
            } else {
                div.innerHTML = `<span class="text-zinc-500">–ü—É—Å—Ç–æ...</span>`;
            }
            save();
            updateUI();
        }

        // === EPSTEIN GAME ===
        let epBet = 1000;
        let epActive = false;
        let epWinnings = 0;

        function openEpsteinModal() {
            if(user.level < 5) return showNotify("–ù—É–∂–µ–Ω 5 —É—Ä–æ–≤–µ–Ω—å!", "error");
            document.getElementById("epstein-modal").classList.remove("hidden");
            resetEpsteinUI();
        }
        function closeEpsteinModal() { document.getElementById("epstein-modal").classList.add("hidden"); epActive = false; }
        
        function setEpsteinBetInput(v) {
            document.getElementById("epstein-bet-input").value = v;
        }

        function resetEpsteinUI() {
            document.getElementById("epstein-grid").innerHTML = '<div class="col-span-4 text-center text-zinc-500 py-10">–°–¥–µ–ª–∞–π —Å—Ç–∞–≤–∫—É</div>';
            document.getElementById("epstein-stats").classList.add("hidden");
            document.getElementById("start-epstein-btn").classList.remove("hidden");
        }

        function startEpsteinGame() {
            epBet = parseInt(document.getElementById("epstein-bet-input").value);
            if(!epBet || epBet <= 0) return;
            if(user.balance < epBet) return showNotify("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ–Ω–µ–≥", "error");

            user.balance -= epBet;
            updateUI();
            
            epActive = true;
            epWinnings = 0;
            
            document.getElementById("start-epstein-btn").classList.add("hidden");
            document.getElementById("epstein-stats").classList.remove("hidden");
            document.getElementById("ep-current-win").textContent = "0 ‚ÇΩ";

            // Generate Grid
            const grid = document.getElementById("epstein-grid");
            grid.innerHTML = "";
            
            // 3 bombs hidden
            let bombs = new Set();
            while(bombs.size < 3) bombs.add(Math.floor(Math.random() * 16));
            
            for(let i=0; i<16; i++) {
                const cell = document.createElement("div");
                cell.className = "aspect-square bg-zinc-800 rounded-xl flex items-center justify-center cursor-pointer hover:bg-zinc-700 transition text-2xl border-b-4 border-zinc-900 active:border-b-0 active:translate-y-1";
                cell.onclick = () => clickEpsteinCell(cell, bombs.has(i));
                grid.appendChild(cell);
            }
        }

        function clickEpsteinCell(cell, isBomb) {
            if(!epActive || cell.classList.contains("opened")) return;
            cell.classList.add("opened", "cursor-default");
            
            if(isBomb) {
                cell.classList.replace("bg-zinc-800", "bg-red-500");
                cell.innerHTML = "üí£";
                epActive = false;
                showNotify("–¢–´ –í–ó–û–†–í–ê–õ–°–Ø!", "error");
                setTimeout(resetEpsteinUI, 1500);
            } else {
                cell.classList.replace("bg-zinc-800", "bg-emerald-500");
                cell.innerHTML = "üíé";
                // Multiplier logic
                const multiplier = 1.2 + (Math.random() * 0.5);
                const win = epWinnings === 0 ? Math.floor(epBet * multiplier) : Math.floor(epWinnings * multiplier);
                epWinnings = win;
                document.getElementById("ep-current-win").textContent = epWinnings + " ‚ÇΩ";
            }
        }

        function cashOutEpstein() {
            if(!epActive || epWinnings === 0) return;
            user.balance += epWinnings;
            addXp(epWinnings/10);
            showNotify(`–ó–∞–±—Ä–∞–ª ${epWinnings} ‚ÇΩ`, "success");
            save();
            updateUI();
            resetEpsteinUI();
            epActive = false;
        }

        // === MRBEAST CRASH (NEW LOGIC) ===
        const crashGame = {
            active: false,
            bet: 1000,
            multiplier: 1.00,
            crashPoint: 0,
            canvas: null,
            ctx: null,
            animId: null,
            startTime: 0,
            history: []
        };

        function openMrBeastModal() {
            if(user.level < 10) return showNotify("–ù—É–∂–µ–Ω 10 —É—Ä–æ–≤–µ–Ω—å!", "error");
            document.getElementById("mrbeast-modal").classList.remove("hidden");
            initCrashCanvas();
        }
        function closeMrBeastModal() {
            document.getElementById("mrbeast-modal").classList.add("hidden");
            if(crashGame.active) loseCrash(); // Close = lose
        }
        
        function doubleCrashBet() { 
            let v = parseInt(document.getElementById("crash-bet-input").value) * 2;
            if(v > user.balance) v = user.balance;
            document.getElementById("crash-bet-input").value = v; 
        }
        function halfCrashBet() {
             let v = Math.floor(parseInt(document.getElementById("crash-bet-input").value) / 2);
             if(v < 100) v = 100;
             document.getElementById("crash-bet-input").value = v; 
        }

        function initCrashCanvas() {
            crashGame.canvas = document.getElementById("crash-canvas");
            crashGame.ctx = crashGame.canvas.getContext("2d");
            // Fix resolution
            const dpr = window.devicePixelRatio || 1;
            const rect = crashGame.canvas.getBoundingClientRect();
            crashGame.canvas.width = rect.width * dpr;
            crashGame.canvas.height = rect.height * dpr;
            crashGame.ctx.scale(dpr, dpr);
            drawCrashGraph(0);
        }

        function startCrash() {
            if(crashGame.active) {
                // Cashout action
                cashOutCrash();
                return;
            }

            const bet = parseInt(document.getElementById("crash-bet-input").value);
            if(bet > user.balance) return showNotify("–ú–∞–ª–æ –¥–µ–Ω–µ–≥", "error");
            
            user.balance -= bet;
            updateUI();
            
            crashGame.bet = bet;
            crashGame.active = true;
            crashGame.multiplier = 1.00;
            crashGame.startTime = Date.now();
            
            // Generate crash point (Weighted randomness)
            // Logic: 0.99 / (1 - random) -> Classic crash algo
            // House edge built in
            const r = Math.random();
            crashGame.crashPoint = Math.floor(100 * 0.96 / (1 - r)) / 100;
            if(crashGame.crashPoint < 1) crashGame.crashPoint = 1;

            // UI Updates
            const btn = document.getElementById("crash-action-btn");
            btn.textContent = "–ó–ê–ë–†–ê–¢–¨";
            btn.className = "w-full md:w-64 bg-emerald-500 hover:bg-emerald-400 text-black text-2xl font-black py-4 rounded-xl";
            document.getElementById("crash-status").classList.add("hidden");
            
            loopCrash();
        }

        function loopCrash() {
            if(!crashGame.active) return;

            const now = Date.now();
            const elapsed = (now - crashGame.startTime) / 1000; // seconds
            
            // Exponential growth function: M = e^(0.06 * t)
            crashGame.multiplier = Math.pow(Math.E, 0.15 * elapsed).toFixed(2);

            document.getElementById("crash-multiplier-display").textContent = crashGame.multiplier + "x";
            document.getElementById("crash-multiplier-display").className = "text-5xl md:text-8xl font-black text-white drop-shadow-md";

            drawCrashGraph(elapsed);

            // Check crash
            if(parseFloat(crashGame.multiplier) >= crashGame.crashPoint) {
                loseCrash();
            } else {
                requestAnimationFrame(loopCrash);
            }
        }

        function drawCrashGraph(t) {
            const ctx = crashGame.ctx;
            const w = crashGame.canvas.width / window.devicePixelRatio;
            const h = crashGame.canvas.height / window.devicePixelRatio;
            
            ctx.clearRect(0,0,w,h);
            
            // Rocket path
            ctx.beginPath();
            ctx.strokeStyle = "#22d3ee"; // Cyan
            ctx.lineWidth = 4;
            
            // Simple curve visualization
            ctx.moveTo(0, h);
            // x goes from 0 to w based on time (scale time to width roughly)
            // y goes up exponentially
            const x = Math.min(t * 30, w - 50); // Speed
            const y = h - Math.min((parseFloat(crashGame.multiplier)-1) * 30, h - 50);
            
            ctx.quadraticCurveTo(x/2, h, x, y);
            ctx.stroke();
            
            // Rocket Icon
            ctx.font = "30px Arial";
            ctx.fillText("üöÄ", x - 15, y);
        }

        function cashOutCrash() {
            crashGame.active = false;
            const win = Math.floor(crashGame.bet * crashGame.multiplier);
            user.balance += win;
            addXp(win/50);
            save();
            updateUI();
            
            showNotify(`–í–´–í–ï–õ: ${win} ‚ÇΩ`, "success");
            
            resetCrashButton();
            document.getElementById("crash-multiplier-display").className = "text-5xl md:text-8xl font-black text-emerald-400 drop-shadow-md";
        }

        function loseCrash() {
            crashGame.active = false;
            document.getElementById("crash-status").classList.remove("hidden");
            document.getElementById("crashed-at-val").textContent = `@ ${crashGame.crashPoint}x`;
            document.getElementById("crash-multiplier-display").textContent = crashGame.crashPoint + "x";
            document.getElementById("crash-multiplier-display").className = "text-5xl md:text-8xl font-black text-red-600 opacity-20";
            
            showNotify("–†–ê–ö–ï–¢–ê –í–ó–û–†–í–ê–õ–ê–°–¨!", "error");
            resetCrashButton();
        }

        function resetCrashButton() {
            const btn = document.getElementById("crash-action-btn");
            btn.textContent = "–°–¢–ê–†–¢";
            btn.className = "w-full md:w-64 bg-cyan-500 hover:bg-cyan-400 text-black text-2xl font-black py-4 rounded-xl shadow-[0_5px_0_#0e7490] active:translate-y-1 active:shadow-none transition";
        }

        // Start
        window.onload = init;
    </script>
</body>
</html>
